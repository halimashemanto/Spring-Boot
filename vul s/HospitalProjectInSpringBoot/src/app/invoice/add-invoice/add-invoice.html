<div style="max-width:900px;margin:auto;padding:25px;font-family:Arial,sans-serif;background:#f8f9fa;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.1);">

  <h2 style="text-align:center;color:#2c3e50;margin-bottom:20px;">ðŸ§¾ Create Invoice</h2>

  <!-- Patient Info -->
  <div style="background:white;padding:20px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 6px rgba(0,0,0,0.05);">
    <h3 style="color:#34495e;margin-bottom:15px;border-bottom:2px solid #eee;padding-bottom:5px;">ðŸ‘¤ Patient Information</h3>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
      <div>
        <label style="font-weight:bold;">Patient Name:</label>
        <input type="text" [(ngModel)]="invoice.patientName" (ngModelChange)="calculateTotal()" 
               style="width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:6px;">
      </div>
      <div>
        <label style="font-weight:bold;">Patient Contact:</label>
        <input type="text" [(ngModel)]="invoice.patientContact" (ngModelChange)="calculateTotal()" 
               style="width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:6px;">
      </div>
    </div>
  </div>

  <!-- Doctor -->
  <div style="background:white;padding:20px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 6px rgba(0,0,0,0.05);">
    <h3 style="color:#34495e;margin-bottom:15px;border-bottom:2px solid #eee;padding-bottom:5px;">ðŸ©º Doctor</h3>
    <select [(ngModel)]="invoice.doctorId" (ngModelChange)="calculateTotal()" 
            style="width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;">
      <option value="0" disabled>Select Doctor</option>
      <option *ngFor="let d of doctors" [value]="d.id">{{d.name}}</option>
    </select>
  </div>

  <!-- Tests -->
  <div style="background:white;padding:20px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 6px rgba(0,0,0,0.05);">
    <h3 style="color:#34495e;margin-bottom:15px;border-bottom:2px solid #eee;padding-bottom:5px;">ðŸ§ª Tests</h3>

    <div *ngFor="let t of invoice.testDetails; let i=index" 
         style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
      <select [(ngModel)]="t.id" (ngModelChange)="onTestChange(t)" 
              style="flex:1;padding:10px;border:1px solid #ccc;border-radius:6px;">
        <option value="0" disabled>Select Test</option>
        <option *ngFor="let test of tests" [value]="test.id">
          {{test.testName}} - {{test.testPrice}} BDT
        </option>
      </select>
      <button type="button" (click)="removeTest(i)" 
              style="padding:8px 14px;background:#e74c3c;color:white;border:none;border-radius:6px;cursor:pointer;">
        âœ–
      </button>
    </div>

    <button type="button" (click)="addTest()" 
            style="padding:10px 20px;background:#27ae60;color:white;border:none;border-radius:6px;cursor:pointer;">
      âž• Add Test
    </button>
  </div>

  <!-- Payment -->
  <div style="background:white;padding:20px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 6px rgba(0,0,0,0.05);">
    <h3 style="color:#34495e;margin-bottom:15px;border-bottom:2px solid #eee;padding-bottom:5px;">ðŸ’° Payment</h3>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;">
      <div>
        <label style="font-weight:bold;">Discount (%):</label>
        <input type="number" [(ngModel)]="invoice.discount" (ngModelChange)="calculateTotal()" 
               style="width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:6px;">
      </div>
      <div>
        <label style="font-weight:bold;">Received:</label>
        <input type="number" [(ngModel)]="invoice.received" (ngModelChange)="calculateTotal()" 
               style="width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:6px;">
      </div>
    </div>

    <div style="background:#f4f6f7;padding:15px;border-radius:8px;font-size:16px;line-height:1.8;">
      <p><strong>Amount:</strong> {{ invoice.amount }} BDT</p>
      <p><strong>Total Amount:</strong> {{ invoice.totalAmount }} BDT</p>
      <p><strong>Due:</strong> {{ invoice.due }} BDT</p>
    </div>
  </div>

  <!-- Save Button -->
  <div style="text-align:center;">
    <button type="button" (click)="saveInvoice()" 
            style="padding:12px 28px;background:#2980b9;color:white;font-size:16px;border:none;border-radius:8px;cursor:pointer;box-shadow:0 3px 6px rgba(0,0,0,0.15);">
      ðŸ’¾ Save & Generate PDF
    </button>
  </div>
</div>
